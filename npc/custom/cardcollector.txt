//===== Hercules Script ======================================
//= Card Collector
//===== By: ==================================================
//= Ozcodex
//===== Current Version: =====================================
//= 3.3
//===== Description: =========================================
//= An investigator who travels the world collecting cards
//= with their team, documenting every card's power and origin.
//===== Additional Comments: =================================
//= 1.0 Initial script - dialog only
//= 1.1 Added card helper registration and inventory checking
//= 2.0 Full card tracking system with progress, missing, and collection view
//= 2.1 Fixed variable length issue by splitting storage by category
//= 2.2 Fixed infinite loop for returning players - added dialogue clear
//= 3.0 Complete refactor - removed infinite loops, simplified menu flow
//=     Removed all color codes and decorators, menu executes once then exits
//= 3.1 Fixed infinite loop in Register Cards and Check Progress options
//=     - Added missing close statement after switch block
//=     - Removed trailing next statements that blocked dialogue flow
//= 3.2 Fixed card registration and detection issues
//=     - AddCardToCategory now initializes variables with "|" prefix
//=     - This ensures strpos() correctly finds cards in format "|ID1|ID2|"
//=     - RegCardsInv now shows message even when no cards found
//=     - Added MigrateOldFormat to fix existing data from old format
//= 3.3 Refactored to separate data operations from UI
//=     - Functions now return data instead of displaying dialogs
//=     - RegCardsInv returns card counts via @reg_total and @reg_new
//=     - ShowProgress builds progress strings in @progress_line1$ through @progress_line10$
//=     - All dialog display happens in main menu after switch
//=     - Added debugmes statements for troubleshooting
//=     - Changed Cecil Damond Card (4368) from S to C
//============================================================

-	script	Card Collector	FAKE_NPC,{
	function RegCardsInv; function ShowProgress; function FindMissing; function ViewCollect;
	function ShowMissingLtr; function ShowMissingType; function ShowCollectLtr; function ShowCollectType;
	function CountFound; function GetCardCat_Orig; function IsCardFound; function AddCardToCategory;
	function MigrateOldFormat;
	
	debugmes "[CardCollector] NPC interaction started";
	
	// Migrate old format data on first interaction
	if (#CARD_HELPER == 1 && #CARD_MIGRATED != 1) {
		debugmes "[CardCollector] Migrating old format data";
		MigrateOldFormat();
		#CARD_MIGRATED = 1;
	}
	
	mes .npc_name$;
	mes "Greetings, adventurer! I'm a card researcher and collector.";
	mes "My team and I travel across these lands documenting";
	mes "and collecting every card we can find.";
	next;
	
	// Check if already registered as helper
	if (#CARD_HELPER != 1) {
		debugmes "[CardCollector] New user - offering helper registration";
		mes .npc_name$;
		mes "We're on a mission to gather and study all known cards";
		mes "in this world. It's quite the ambitious goal, I know!";
		next;
		
		mes .npc_name$;
		mes "Would you be interested in helping us with our search?";
		next;
		
		if (select("Yes, I'll help!", "Maybe later") == 1) {
			#CARD_HELPER = 1;
			debugmes "[CardCollector] User accepted - registered as helper";
			mes .npc_name$;
			mes "Excellent! Welcome to our team, collector!";
			next;
		} else {
			debugmes "[CardCollector] User declined helper registration";
			mes .npc_name$;
			mes "Should you ever come across rare or unique cards,";
			mes "we would be most interested in seeing them.";
			close;
		}
	} else {
		debugmes "[CardCollector] Returning helper";
	}
	
	// Main menu - no loop, exits after one action
	mes .npc_name$;
	mes "What would you like to do?";
	next;
	
	switch(select("Register Cards in Inventory", "Check Progress", "View My Collection", "Find Missing Cards", "Exit")) {
		case 1: // Register Cards
			debugmes "[CardCollector] Main: User selected 'Register Cards'";
			RegCardsInv();
			// Display results
			mes .npc_name$;
			if (@reg_total > 0) {
				mes "I found " + @reg_total + " unique card" + (@reg_total == 1 ? "" : "s") + " in your inventory!";
				if (@reg_new > 0) {
					mes "Of those, " + @reg_new + " " + (@reg_new == 1 ? "is" : "are") + " new to our collection!";
				} else {
					mes "All of them were already registered.";
				}
			} else {
				mes "You don't have any cards in your inventory.";
			}
			break;
		case 2: // Check Progress
			debugmes "[CardCollector] Main: User selected 'Check Progress'";
			ShowProgress();
			// Display progress data
			mes .npc_name$;
			mes "=== COLLECTION PROGRESS ===";
			next;
			mes @progress_line1$;
			mes @progress_line2$;
			mes @progress_line3$;
			mes @progress_line4$;
			next;
			mes @progress_line5$;
			mes @progress_line6$;
			mes @progress_line7$;
			mes @progress_line8$;
			next;
			mes "=== SPECIAL CARDS ===";
			mes @progress_line9$;
			mes @progress_line10$;
			break;
		case 3: // View Collection
			debugmes "[CardCollector] Main: User selected 'View Collection'";
			ViewCollect();
			break;
		case 4: // Find Missing Cards
			debugmes "[CardCollector] Main: User selected 'Find Missing'";
			FindMissing();
			break;
		case 5: // Exit
			debugmes "[CardCollector] Main: User selected 'Exit'";
			mes .npc_name$;
			mes "Keep searching, collector! Every card counts!";
			close;
	}
	close;

// ===== FUNCTION: Register Cards From Inventory =====
// Returns: array with [total_unique, new_cards]
function RegCardsInv {
	debugmes "[CardCollector] RegCardsInv: Starting card registration";
	.@total_unique = 0;
	.@new_cards = 0;
	
	getinventorylist();
	debugmes "[CardCollector] RegCardsInv: Found " + @inventorylist_count + " items in inventory";
	
	for (.@i = 0; .@i < @inventorylist_count; .@i++) {
		.@item_id = @inventorylist_id[.@i];
		
		// Check if item is a card (type 6)
		if (getiteminfo(.@item_id, ITEMINFO_TYPE) == IT_CARD) {
			.@total_unique++;
			debugmes "[CardCollector] RegCardsInv: Found card ID " + .@item_id + " (" + getitemname(.@item_id) + ")";
			
			// Determine which category this card belongs to
			.@category$ = GetCardCat_Orig(.@item_id);
			debugmes "[CardCollector] RegCardsInv: Card " + .@item_id + " belongs to category: " + .@category$;
			
			// Check if card is already registered in its category
			if (!IsCardFound(.@item_id, .@category$)) {
				// Add card to found list in appropriate category
				AddCardToCategory(.@item_id, .@category$);
				.@new_cards++;
				debugmes "[CardCollector] RegCardsInv: Registered NEW card " + .@item_id + " in category " + .@category$;
			} else {
				debugmes "[CardCollector] RegCardsInv: Card " + .@item_id + " already registered";
			}
		}
	}
	
	debugmes "[CardCollector] RegCardsInv: Complete - Total unique: " + .@total_unique + ", New cards: " + .@new_cards;
	// Store results in temporary variables for caller to use
	@reg_total = .@total_unique;
	@reg_new = .@new_cards;
	return;
}

// ===== FUNCTION: Show Progress =====
// Builds progress strings and stores in @progress_line1$ through @progress_line10$
function ShowProgress {
	debugmes "[CardCollector] ShowProgress: Building progress data";
	
	// Count found cards per letter
	// Line 1: A, B, C
	.@cA = CountFound("A");
	.@cB = CountFound("B");
	.@cC = CountFound("C");
	.@tA = getarraysize(.carta_A);
	.@tB = getarraysize(.carta_B);
	.@tC = getarraysize(.carta_C);
	@progress_line1$ = "A: " + .@cA + "/" + .@tA + "  ";
	@progress_line1$ = @progress_line1$ + "B: " + .@cB + "/" + .@tB + "  ";
	@progress_line1$ = @progress_line1$ + "C: " + .@cC + "/" + .@tC;
	
	// Line 2: D, F, G
	.@cD = CountFound("D");
	.@cF = CountFound("F");
	.@cG = CountFound("G");
	.@tD = getarraysize(.carta_D);
	.@tF = getarraysize(.carta_F);
	.@tG = getarraysize(.carta_G);
	@progress_line2$ = "D: " + .@cD + "/" + .@tD + "  ";
	@progress_line2$ = @progress_line2$ + "F: " + .@cF + "/" + .@tF + "  ";
	@progress_line2$ = @progress_line2$ + "G: " + .@cG + "/" + .@tG;
	
	// Line 3: H, I, J
	.@cH = CountFound("H");
	.@cI = CountFound("I");
	.@cJ = CountFound("J");
	.@tH = getarraysize(.carta_H);
	.@tI = getarraysize(.carta_I);
	.@tJ = getarraysize(.carta_J);
	@progress_line3$ = "H: " + .@cH + "/" + .@tH + "  ";
	@progress_line3$ = @progress_line3$ + "I: " + .@cI + "/" + .@tI + "  ";
	@progress_line3$ = @progress_line3$ + "J: " + .@cJ + "/" + .@tJ;
	
	// Line 4: K, L, M
	.@cK = CountFound("K");
	.@cL = CountFound("L");
	.@cM = CountFound("M");
	.@tK = getarraysize(.carta_K);
	.@tL = getarraysize(.carta_L);
	.@tM = getarraysize(.carta_M);
	@progress_line4$ = "K: " + .@cK + "/" + .@tK + "  ";
	@progress_line4$ = @progress_line4$ + "L: " + .@cL + "/" + .@tL + "  ";
	@progress_line4$ = @progress_line4$ + "M: " + .@cM + "/" + .@tM;
	
	// Line 5: N, O, P
	.@cN = CountFound("N");
	.@cO = CountFound("O");
	.@cP = CountFound("P");
	.@tN = getarraysize(.carta_N);
	.@tO = getarraysize(.carta_O);
	.@tP = getarraysize(.carta_P);
	@progress_line5$ = "N: " + .@cN + "/" + .@tN + "  ";
	@progress_line5$ = @progress_line5$ + "O: " + .@cO + "/" + .@tO + "  ";
	@progress_line5$ = @progress_line5$ + "P: " + .@cP + "/" + .@tP;
	
	// Line 6: Q, R, S
	.@cQ = CountFound("Q");
	.@cR = CountFound("R");
	.@cS = CountFound("S");
	.@tQ = getarraysize(.carta_Q);
	.@tR = getarraysize(.carta_R);
	.@tS = getarraysize(.carta_S);
	@progress_line6$ = "Q: " + .@cQ + "/" + .@tQ + "  ";
	@progress_line6$ = @progress_line6$ + "R: " + .@cR + "/" + .@tR + "  ";
	@progress_line6$ = @progress_line6$ + "S: " + .@cS + "/" + .@tS;
	
	// Line 7: T, U, V
	.@cT = CountFound("T");
	.@cU = CountFound("U");
	.@cV = CountFound("V");
	.@tT = getarraysize(.carta_T);
	.@tU = getarraysize(.carta_U);
	.@tV = getarraysize(.carta_V);
	@progress_line7$ = "T: " + .@cT + "/" + .@tT + "  ";
	@progress_line7$ = @progress_line7$ + "U: " + .@cU + "/" + .@tU + "  ";
	@progress_line7$ = @progress_line7$ + "V: " + .@cV + "/" + .@tV;
	
	// Line 8: W, Y, Z
	.@cW = CountFound("W");
	.@cY = CountFound("Y");
	.@cZ = CountFound("Z");
	.@tW = getarraysize(.carta_W);
	.@tY = getarraysize(.carta_Y);
	.@tZ = getarraysize(.carta_Z);
	@progress_line8$ = "W: " + .@cW + "/" + .@tW + "  ";
	@progress_line8$ = @progress_line8$ + "Y: " + .@cY + "/" + .@tY + "  ";
	@progress_line8$ = @progress_line8$ + "Z: " + .@cZ + "/" + .@tZ;
	
	// Special categories
	.@cBOSS = CountFound("BOSS");
	.@cMVP = CountFound("MVP");
	.@tBOSS = getarraysize(.carta_BOSS);
	.@tMVP = getarraysize(.carta_MVP);
	@progress_line9$ = "BOSS: " + .@cBOSS + "/" + .@tBOSS;
	@progress_line10$ = "MVP: " + .@cMVP + "/" + .@tMVP;
	
	debugmes "[CardCollector] ShowProgress: Progress data built successfully";
	return;
}

// ===== FUNCTION: Find Missing Cards =====
function FindMissing {
	mes .npc_name$;
	mes "Which cards would you like to search for?";
	mes "Enter a letter (A-Z) or 'BOSS' or 'MVP'.";
	next;
	
	input .@search$;
	.@search$ = strtoupper(.@search$);
	
	// Validate input
	if (.@search$ == "") {
		mes .npc_name$;
		mes "Please enter a single letter or 'BOSS' or 'MVP'.";
		close;
		return;
	}
	
	// Validate letter (single character)
	if (getstrlen(.@search$) == 1) {
		if (.@search$ != "A" && .@search$ != "B" && .@search$ != "C" && 
		    .@search$ != "D" && .@search$ != "F" && .@search$ != "G" && 
		    .@search$ != "H" && .@search$ != "I" && .@search$ != "J" && 
		    .@search$ != "K" && .@search$ != "L" && .@search$ != "M" && 
		    .@search$ != "N" && .@search$ != "O" && .@search$ != "P" && 
		    .@search$ != "Q" && .@search$ != "R" && .@search$ != "S" && 
		    .@search$ != "T" && .@search$ != "U" && .@search$ != "V" && 
		    .@search$ != "W" && .@search$ != "Y" && .@search$ != "Z") {
			mes .npc_name$;
			mes "That's not a valid letter!";
			close;
			return;
		}
		ShowMissingLtr(.@search$);
	} else if (.@search$ == "BOSS" || .@search$ == "MVP") {
		ShowMissingType(.@search$);
	} else {
		mes .npc_name$;
		mes "Please enter a single letter, 'BOSS', or 'MVP'.";
		close;
	}
	return;
}

// ===== FUNCTION: Display Missing By Letter =====
function ShowMissingLtr {
	.@letter$ = getarg(0);
	.@missing$ = "";
	
	// Get the correct array
	if (.@letter$ == "A") copyarray(.@carta[0], .carta_A[0], getarraysize(.carta_A));
	else if (.@letter$ == "B") copyarray(.@carta[0], .carta_B[0], getarraysize(.carta_B));
	else if (.@letter$ == "C") copyarray(.@carta[0], .carta_C[0], getarraysize(.carta_C));
	else if (.@letter$ == "D") copyarray(.@carta[0], .carta_D[0], getarraysize(.carta_D));
	else if (.@letter$ == "F") copyarray(.@carta[0], .carta_F[0], getarraysize(.carta_F));
	else if (.@letter$ == "G") copyarray(.@carta[0], .carta_G[0], getarraysize(.carta_G));
	else if (.@letter$ == "H") copyarray(.@carta[0], .carta_H[0], getarraysize(.carta_H));
	else if (.@letter$ == "I") copyarray(.@carta[0], .carta_I[0], getarraysize(.carta_I));
	else if (.@letter$ == "J") copyarray(.@carta[0], .carta_J[0], getarraysize(.carta_J));
	else if (.@letter$ == "K") copyarray(.@carta[0], .carta_K[0], getarraysize(.carta_K));
	else if (.@letter$ == "L") copyarray(.@carta[0], .carta_L[0], getarraysize(.carta_L));
	else if (.@letter$ == "M") copyarray(.@carta[0], .carta_M[0], getarraysize(.carta_M));
	else if (.@letter$ == "N") copyarray(.@carta[0], .carta_N[0], getarraysize(.carta_N));
	else if (.@letter$ == "O") copyarray(.@carta[0], .carta_O[0], getarraysize(.carta_O));
	else if (.@letter$ == "P") copyarray(.@carta[0], .carta_P[0], getarraysize(.carta_P));
	else if (.@letter$ == "Q") copyarray(.@carta[0], .carta_Q[0], getarraysize(.carta_Q));
	else if (.@letter$ == "R") copyarray(.@carta[0], .carta_R[0], getarraysize(.carta_R));
	else if (.@letter$ == "S") copyarray(.@carta[0], .carta_S[0], getarraysize(.carta_S));
	else if (.@letter$ == "T") copyarray(.@carta[0], .carta_T[0], getarraysize(.carta_T));
	else if (.@letter$ == "U") copyarray(.@carta[0], .carta_U[0], getarraysize(.carta_U));
	else if (.@letter$ == "V") copyarray(.@carta[0], .carta_V[0], getarraysize(.carta_V));
	else if (.@letter$ == "W") copyarray(.@carta[0], .carta_W[0], getarraysize(.carta_W));
	else if (.@letter$ == "Y") copyarray(.@carta[0], .carta_Y[0], getarraysize(.carta_Y));
	else if (.@letter$ == "Z") copyarray(.@carta[0], .carta_Z[0], getarraysize(.carta_Z));
	
	// Find missing cards
	for (.@i = 0; .@i < getarraysize(.@carta); .@i++) {
		if (!IsCardFound(.@carta[.@i], .@letter$)) {
			if (.@missing$ == "") {
				.@missing$ = getitemname(.@carta[.@i]);
			} else {
				.@missing$ = .@missing$ + ", " + getitemname(.@carta[.@i]);
			}
		}
	}
	
	mes .npc_name$;
	if (.@missing$ == "") {
		mes "Congratulations! You have all cards from letter " + .@letter$ + "!";
	} else {
		mes "Missing cards from letter " + .@letter$ + ":";
		mes .@missing$;
	}
	close;
	return;
}

// ===== FUNCTION: Display Missing By Type =====
function ShowMissingType {
	.@type$ = getarg(0);
	.@missing$ = "";
	
	if (.@type$ == "BOSS") copyarray(.@carta[0], .carta_BOSS[0], getarraysize(.carta_BOSS));
	else if (.@type$ == "MVP") copyarray(.@carta[0], .carta_MVP[0], getarraysize(.carta_MVP));
	
	// Find missing cards
	for (.@i = 0; .@i < getarraysize(.@carta); .@i++) {
		if (!IsCardFound(.@carta[.@i], .@type$)) {
			if (.@missing$ == "") {
				.@missing$ = getitemname(.@carta[.@i]);
			} else {
				.@missing$ = .@missing$ + ", " + getitemname(.@carta[.@i]);
			}
		}
	}
	
	mes .npc_name$;
	if (.@missing$ == "") {
		mes "Congratulations! You have all " + .@type$ + " cards!";
	} else {
		mes "Missing " + .@type$ + " cards:";
		mes .@missing$;
	}
	close;
	return;
}

// ===== FUNCTION: View Collection =====
function ViewCollect {
	mes .npc_name$;
	mes "Which cards would you like to review?";
	mes "Enter a letter (A-Z) or 'BOSS' or 'MVP'.";
	next;
	
	input .@search$;
	.@search$ = strtoupper(.@search$);
	
	// Validate input
	if (.@search$ == "") {
		mes .npc_name$;
		mes "Please enter a single letter or 'BOSS' or 'MVP'.";
		close;
		return;
	}
	
	// Validate letter (single character)
	if (getstrlen(.@search$) == 1) {
		if (.@search$ != "A" && .@search$ != "B" && .@search$ != "C" && 
		    .@search$ != "D" && .@search$ != "F" && .@search$ != "G" && 
		    .@search$ != "H" && .@search$ != "I" && .@search$ != "J" && 
		    .@search$ != "K" && .@search$ != "L" && .@search$ != "M" && 
		    .@search$ != "N" && .@search$ != "O" && .@search$ != "P" && 
		    .@search$ != "Q" && .@search$ != "R" && .@search$ != "S" && 
		    .@search$ != "T" && .@search$ != "U" && .@search$ != "V" && 
		    .@search$ != "W" && .@search$ != "Y" && .@search$ != "Z") {
			mes .npc_name$;
			mes "That's not a valid letter!";
			close;
			return;
		}
		ShowCollectLtr(.@search$);
	} else if (.@search$ == "BOSS" || .@search$ == "MVP") {
		ShowCollectType(.@search$);
	} else {
		mes .npc_name$;
		mes "Please enter a single letter, 'BOSS', or 'MVP'.";
		close;
	}
	return;
}

// ===== FUNCTION: Display Collection By Letter =====
function ShowCollectLtr {
	.@letter$ = getarg(0);
	.@collection$ = "";
	
	// Get the correct array
	if (.@letter$ == "A") copyarray(.@carta[0], .carta_A[0], getarraysize(.carta_A));
	else if (.@letter$ == "B") copyarray(.@carta[0], .carta_B[0], getarraysize(.carta_B));
	else if (.@letter$ == "C") copyarray(.@carta[0], .carta_C[0], getarraysize(.carta_C));
	else if (.@letter$ == "D") copyarray(.@carta[0], .carta_D[0], getarraysize(.carta_D));
	else if (.@letter$ == "F") copyarray(.@carta[0], .carta_F[0], getarraysize(.carta_F));
	else if (.@letter$ == "G") copyarray(.@carta[0], .carta_G[0], getarraysize(.carta_G));
	else if (.@letter$ == "H") copyarray(.@carta[0], .carta_H[0], getarraysize(.carta_H));
	else if (.@letter$ == "I") copyarray(.@carta[0], .carta_I[0], getarraysize(.carta_I));
	else if (.@letter$ == "J") copyarray(.@carta[0], .carta_J[0], getarraysize(.carta_J));
	else if (.@letter$ == "K") copyarray(.@carta[0], .carta_K[0], getarraysize(.carta_K));
	else if (.@letter$ == "L") copyarray(.@carta[0], .carta_L[0], getarraysize(.carta_L));
	else if (.@letter$ == "M") copyarray(.@carta[0], .carta_M[0], getarraysize(.carta_M));
	else if (.@letter$ == "N") copyarray(.@carta[0], .carta_N[0], getarraysize(.carta_N));
	else if (.@letter$ == "O") copyarray(.@carta[0], .carta_O[0], getarraysize(.carta_O));
	else if (.@letter$ == "P") copyarray(.@carta[0], .carta_P[0], getarraysize(.carta_P));
	else if (.@letter$ == "Q") copyarray(.@carta[0], .carta_Q[0], getarraysize(.carta_Q));
	else if (.@letter$ == "R") copyarray(.@carta[0], .carta_R[0], getarraysize(.carta_R));
	else if (.@letter$ == "S") copyarray(.@carta[0], .carta_S[0], getarraysize(.carta_S));
	else if (.@letter$ == "T") copyarray(.@carta[0], .carta_T[0], getarraysize(.carta_T));
	else if (.@letter$ == "U") copyarray(.@carta[0], .carta_U[0], getarraysize(.carta_U));
	else if (.@letter$ == "V") copyarray(.@carta[0], .carta_V[0], getarraysize(.carta_V));
	else if (.@letter$ == "W") copyarray(.@carta[0], .carta_W[0], getarraysize(.carta_W));
	else if (.@letter$ == "Y") copyarray(.@carta[0], .carta_Y[0], getarraysize(.carta_Y));
	else if (.@letter$ == "Z") copyarray(.@carta[0], .carta_Z[0], getarraysize(.carta_Z));
	
	// Find found cards
	for (.@i = 0; .@i < getarraysize(.@carta); .@i++) {
		if (IsCardFound(.@carta[.@i], .@letter$)) {
			if (.@collection$ == "") {
				.@collection$ = getitemname(.@carta[.@i]);
			} else {
				.@collection$ = .@collection$ + ", " + getitemname(.@carta[.@i]);
			}
		}
	}
	
	mes .npc_name$;
	if (.@collection$ == "") {
		mes "You don't have any cards from letter " + .@letter$ + " yet.";
	} else {
		mes "Cards from letter " + .@letter$ + ":";
		mes .@collection$;
	}
	close;
	return;
}

// ===== FUNCTION: Display Collection By Type =====
function ShowCollectType {
	.@type$ = getarg(0);
	.@collection$ = "";
	
	if (.@type$ == "BOSS") copyarray(.@carta[0], .carta_BOSS[0], getarraysize(.carta_BOSS));
	else if (.@type$ == "MVP") copyarray(.@carta[0], .carta_MVP[0], getarraysize(.carta_MVP));
	
	// Find found cards
	for (.@i = 0; .@i < getarraysize(.@carta); .@i++) {
		if (IsCardFound(.@carta[.@i], .@type$)) {
			if (.@collection$ == "") {
				.@collection$ = getitemname(.@carta[.@i]);
			} else {
				.@collection$ = .@collection$ + ", " + getitemname(.@carta[.@i]);
			}
		}
	}
	
	mes .npc_name$;
	if (.@collection$ == "") {
		mes "You don't have any " + .@type$ + " cards yet.";
	} else {
		mes "Your " + .@type$ + " cards:";
		mes .@collection$;
	}
	close;
	return;
}

// ===== FUNCTION: Count Found Cards =====
function CountFound {
	.@letter$ = getarg(0);
	.@count = 0;
	
	// Get the correct array
	if (.@letter$ == "A") copyarray(.@carta[0], .carta_A[0], getarraysize(.carta_A));
	else if (.@letter$ == "B") copyarray(.@carta[0], .carta_B[0], getarraysize(.carta_B));
	else if (.@letter$ == "C") copyarray(.@carta[0], .carta_C[0], getarraysize(.carta_C));
	else if (.@letter$ == "D") copyarray(.@carta[0], .carta_D[0], getarraysize(.carta_D));
	else if (.@letter$ == "F") copyarray(.@carta[0], .carta_F[0], getarraysize(.carta_F));
	else if (.@letter$ == "G") copyarray(.@carta[0], .carta_G[0], getarraysize(.carta_G));
	else if (.@letter$ == "H") copyarray(.@carta[0], .carta_H[0], getarraysize(.carta_H));
	else if (.@letter$ == "I") copyarray(.@carta[0], .carta_I[0], getarraysize(.carta_I));
	else if (.@letter$ == "J") copyarray(.@carta[0], .carta_J[0], getarraysize(.carta_J));
	else if (.@letter$ == "K") copyarray(.@carta[0], .carta_K[0], getarraysize(.carta_K));
	else if (.@letter$ == "L") copyarray(.@carta[0], .carta_L[0], getarraysize(.carta_L));
	else if (.@letter$ == "M") copyarray(.@carta[0], .carta_M[0], getarraysize(.carta_M));
	else if (.@letter$ == "N") copyarray(.@carta[0], .carta_N[0], getarraysize(.carta_N));
	else if (.@letter$ == "O") copyarray(.@carta[0], .carta_O[0], getarraysize(.carta_O));
	else if (.@letter$ == "P") copyarray(.@carta[0], .carta_P[0], getarraysize(.carta_P));
	else if (.@letter$ == "Q") copyarray(.@carta[0], .carta_Q[0], getarraysize(.carta_Q));
	else if (.@letter$ == "R") copyarray(.@carta[0], .carta_R[0], getarraysize(.carta_R));
	else if (.@letter$ == "S") copyarray(.@carta[0], .carta_S[0], getarraysize(.carta_S));
	else if (.@letter$ == "T") copyarray(.@carta[0], .carta_T[0], getarraysize(.carta_T));
	else if (.@letter$ == "U") copyarray(.@carta[0], .carta_U[0], getarraysize(.carta_U));
	else if (.@letter$ == "V") copyarray(.@carta[0], .carta_V[0], getarraysize(.carta_V));
	else if (.@letter$ == "W") copyarray(.@carta[0], .carta_W[0], getarraysize(.carta_W));
	else if (.@letter$ == "Y") copyarray(.@carta[0], .carta_Y[0], getarraysize(.carta_Y));
	else if (.@letter$ == "Z") copyarray(.@carta[0], .carta_Z[0], getarraysize(.carta_Z));
	else if (.@letter$ == "BOSS") copyarray(.@carta[0], .carta_BOSS[0], getarraysize(.carta_BOSS));
	else if (.@letter$ == "MVP") copyarray(.@carta[0], .carta_MVP[0], getarraysize(.carta_MVP));
	
	// Count found cards
	for (.@i = 0; .@i < getarraysize(.@carta); .@i++) {
		if (IsCardFound(.@carta[.@i], .@letter$)) {
			.@count++;
		}
	}
	
	return .@count;
}

// ===== FUNCTION: Get Card Array Reference =====
// Helper to avoid duplicating 26+ if-else chains
function GetCardArray {
	.@letter$ = getarg(0);
	
	if (.@letter$ == "A") return .carta_A;
	else if (.@letter$ == "B") return .carta_B;
	else if (.@letter$ == "C") return .carta_C;
	else if (.@letter$ == "D") return .carta_D;
	else if (.@letter$ == "F") return .carta_F;
	else if (.@letter$ == "G") return .carta_G;
	else if (.@letter$ == "H") return .carta_H;
	else if (.@letter$ == "I") return .carta_I;
	else if (.@letter$ == "J") return .carta_J;
	else if (.@letter$ == "K") return .carta_K;
	else if (.@letter$ == "L") return .carta_L;
	else if (.@letter$ == "M") return .carta_M;
	else if (.@letter$ == "N") return .carta_N;
	else if (.@letter$ == "O") return .carta_O;
	else if (.@letter$ == "P") return .carta_P;
	else if (.@letter$ == "Q") return .carta_Q;
	else if (.@letter$ == "R") return .carta_R;
	else if (.@letter$ == "S") return .carta_S;
	else if (.@letter$ == "T") return .carta_T;
	else if (.@letter$ == "U") return .carta_U;
	else if (.@letter$ == "V") return .carta_V;
	else if (.@letter$ == "W") return .carta_W;
	else if (.@letter$ == "Y") return .carta_Y;
	else if (.@letter$ == "Z") return .carta_Z;
	else if (.@letter$ == "BOSS") return .carta_BOSS;
	else if (.@letter$ == "MVP") return .carta_MVP;
	
	return;
}

// ===== FUNCTION: Get Card Category =====
function GetCardCat_Orig {
	.@item_id = getarg(0);
	debugmes "[GetCardCat_Orig] Searching for card ID: " + .@item_id;
	debugmes "[GetCardCat_Orig] carta_P size: " + getarraysize(.carta_P);
	debugmes "[GetCardCat_Orig] carta_P[0]: " + .carta_P[0];
	debugmes "[GetCardCat_Orig] carta_P[1]: " + .carta_P[1];
	debugmes "[GetCardCat_Orig] carta_P[2]: " + .carta_P[2];
	
	// Check each category
	for (.@i = 0; .@i < getarraysize(.carta_A); .@i++) if (.carta_A[.@i] == .@item_id) return "A";
	for (.@i = 0; .@i < getarraysize(.carta_B); .@i++) if (.carta_B[.@i] == .@item_id) return "B";
	for (.@i = 0; .@i < getarraysize(.carta_C); .@i++) if (.carta_C[.@i] == .@item_id) return "C";
	for (.@i = 0; .@i < getarraysize(.carta_D); .@i++) if (.carta_D[.@i] == .@item_id) return "D";
	for (.@i = 0; .@i < getarraysize(.carta_F); .@i++) if (.carta_F[.@i] == .@item_id) return "F";
	for (.@i = 0; .@i < getarraysize(.carta_G); .@i++) if (.carta_G[.@i] == .@item_id) return "G";
	for (.@i = 0; .@i < getarraysize(.carta_H); .@i++) if (.carta_H[.@i] == .@item_id) return "H";
	for (.@i = 0; .@i < getarraysize(.carta_I); .@i++) if (.carta_I[.@i] == .@item_id) return "I";
	for (.@i = 0; .@i < getarraysize(.carta_J); .@i++) if (.carta_J[.@i] == .@item_id) return "J";
	for (.@i = 0; .@i < getarraysize(.carta_K); .@i++) if (.carta_K[.@i] == .@item_id) return "K";
	for (.@i = 0; .@i < getarraysize(.carta_L); .@i++) if (.carta_L[.@i] == .@item_id) return "L";
	for (.@i = 0; .@i < getarraysize(.carta_M); .@i++) if (.carta_M[.@i] == .@item_id) return "M";
	for (.@i = 0; .@i < getarraysize(.carta_N); .@i++) if (.carta_N[.@i] == .@item_id) return "N";
	for (.@i = 0; .@i < getarraysize(.carta_O); .@i++) if (.carta_O[.@i] == .@item_id) return "O";
	for (.@i = 0; .@i < getarraysize(.carta_P); .@i++) if (.carta_P[.@i] == .@item_id) return "P";
	for (.@i = 0; .@i < getarraysize(.carta_Q); .@i++) if (.carta_Q[.@i] == .@item_id) return "Q";
	for (.@i = 0; .@i < getarraysize(.carta_R); .@i++) if (.carta_R[.@i] == .@item_id) return "R";
	for (.@i = 0; .@i < getarraysize(.carta_S); .@i++) if (.carta_S[.@i] == .@item_id) return "S";
	for (.@i = 0; .@i < getarraysize(.carta_T); .@i++) if (.carta_T[.@i] == .@item_id) return "T";
	for (.@i = 0; .@i < getarraysize(.carta_U); .@i++) if (.carta_U[.@i] == .@item_id) return "U";
	for (.@i = 0; .@i < getarraysize(.carta_V); .@i++) if (.carta_V[.@i] == .@item_id) return "V";
	for (.@i = 0; .@i < getarraysize(.carta_W); .@i++) if (.carta_W[.@i] == .@item_id) return "W";
	for (.@i = 0; .@i < getarraysize(.carta_Y); .@i++) if (.carta_Y[.@i] == .@item_id) return "Y";
	for (.@i = 0; .@i < getarraysize(.carta_Z); .@i++) if (.carta_Z[.@i] == .@item_id) return "Z";
	for (.@i = 0; .@i < getarraysize(.carta_BOSS); .@i++) if (.carta_BOSS[.@i] == .@item_id) return "BOSS";
	for (.@i = 0; .@i < getarraysize(.carta_MVP); .@i++) if (.carta_MVP[.@i] == .@item_id) return "MVP";
	
	debugmes "[GetCardCat_Orig] Card not found in any category!";
	return ""; // Unknown card
}

// ===== FUNCTION: Check if Card is Found =====
function IsCardFound {
	.@item_id = getarg(0);
	.@category$ = getarg(1);
	
	// Get the correct variable based on category
	if (.@category$ == "A") return (strpos(#CARD_A$, "|" + .@item_id + "|") != -1);
	else if (.@category$ == "B") return (strpos(#CARD_B$, "|" + .@item_id + "|") != -1);
	else if (.@category$ == "C") return (strpos(#CARD_C$, "|" + .@item_id + "|") != -1);
	else if (.@category$ == "D") return (strpos(#CARD_D$, "|" + .@item_id + "|") != -1);
	else if (.@category$ == "F") return (strpos(#CARD_F$, "|" + .@item_id + "|") != -1);
	else if (.@category$ == "G") return (strpos(#CARD_G$, "|" + .@item_id + "|") != -1);
	else if (.@category$ == "H") return (strpos(#CARD_H$, "|" + .@item_id + "|") != -1);
	else if (.@category$ == "I") return (strpos(#CARD_I$, "|" + .@item_id + "|") != -1);
	else if (.@category$ == "J") return (strpos(#CARD_J$, "|" + .@item_id + "|") != -1);
	else if (.@category$ == "K") return (strpos(#CARD_K$, "|" + .@item_id + "|") != -1);
	else if (.@category$ == "L") return (strpos(#CARD_L$, "|" + .@item_id + "|") != -1);
	else if (.@category$ == "M") return (strpos(#CARD_M$, "|" + .@item_id + "|") != -1);
	else if (.@category$ == "N") return (strpos(#CARD_N$, "|" + .@item_id + "|") != -1);
	else if (.@category$ == "O") return (strpos(#CARD_O$, "|" + .@item_id + "|") != -1);
	else if (.@category$ == "P") return (strpos(#CARD_P$, "|" + .@item_id + "|") != -1);
	else if (.@category$ == "Q") return (strpos(#CARD_Q$, "|" + .@item_id + "|") != -1);
	else if (.@category$ == "R") return (strpos(#CARD_R$, "|" + .@item_id + "|") != -1);
	else if (.@category$ == "S") return (strpos(#CARD_S$, "|" + .@item_id + "|") != -1);
	else if (.@category$ == "T") return (strpos(#CARD_T$, "|" + .@item_id + "|") != -1);
	else if (.@category$ == "U") return (strpos(#CARD_U$, "|" + .@item_id + "|") != -1);
	else if (.@category$ == "V") return (strpos(#CARD_V$, "|" + .@item_id + "|") != -1);
	else if (.@category$ == "W") return (strpos(#CARD_W$, "|" + .@item_id + "|") != -1);
	else if (.@category$ == "Y") return (strpos(#CARD_Y$, "|" + .@item_id + "|") != -1);
	else if (.@category$ == "Z") return (strpos(#CARD_Z$, "|" + .@item_id + "|") != -1);
	else if (.@category$ == "BOSS") {
		// BOSS split into two variables
		if (strpos(#CARD_BOSS1$, "|" + .@item_id + "|") != -1) return 1;
		if (strpos(#CARD_BOSS2$, "|" + .@item_id + "|") != -1) return 1;
		return 0;
	}
	else if (.@category$ == "MVP") {
		// MVP split into two variables
		if (strpos(#CARD_MVP1$, "|" + .@item_id + "|") != -1) return 1;
		if (strpos(#CARD_MVP2$, "|" + .@item_id + "|") != -1) return 1;
		return 0;
	}
	
	return 0;
}

// ===== FUNCTION: Add Card to Category =====
function AddCardToCategory {
	.@item_id = getarg(0);
	.@category$ = getarg(1);
	
	debugmes "[CardCollector] AddCardToCategory: Adding card " + .@item_id + " to category " + .@category$;
	
	// Add card to the correct variable based on category
	// If variable is empty, start with "|" to match strpos search pattern
	if (.@category$ == "A") {
		if (#CARD_A$ == "") #CARD_A$ = "|";
		#CARD_A$ = #CARD_A$ + .@item_id + "|";
	}
	else if (.@category$ == "B") {
		if (#CARD_B$ == "") #CARD_B$ = "|";
		#CARD_B$ = #CARD_B$ + .@item_id + "|";
	}
	else if (.@category$ == "C") {
		if (#CARD_C$ == "") #CARD_C$ = "|";
		#CARD_C$ = #CARD_C$ + .@item_id + "|";
	}
	else if (.@category$ == "D") {
		if (#CARD_D$ == "") #CARD_D$ = "|";
		#CARD_D$ = #CARD_D$ + .@item_id + "|";
	}
	else if (.@category$ == "F") {
		if (#CARD_F$ == "") #CARD_F$ = "|";
		#CARD_F$ = #CARD_F$ + .@item_id + "|";
	}
	else if (.@category$ == "G") {
		if (#CARD_G$ == "") #CARD_G$ = "|";
		#CARD_G$ = #CARD_G$ + .@item_id + "|";
	}
	else if (.@category$ == "H") {
		if (#CARD_H$ == "") #CARD_H$ = "|";
		#CARD_H$ = #CARD_H$ + .@item_id + "|";
	}
	else if (.@category$ == "I") {
		if (#CARD_I$ == "") #CARD_I$ = "|";
		#CARD_I$ = #CARD_I$ + .@item_id + "|";
	}
	else if (.@category$ == "J") {
		if (#CARD_J$ == "") #CARD_J$ = "|";
		#CARD_J$ = #CARD_J$ + .@item_id + "|";
	}
	else if (.@category$ == "K") {
		if (#CARD_K$ == "") #CARD_K$ = "|";
		#CARD_K$ = #CARD_K$ + .@item_id + "|";
	}
	else if (.@category$ == "L") {
		if (#CARD_L$ == "") #CARD_L$ = "|";
		#CARD_L$ = #CARD_L$ + .@item_id + "|";
	}
	else if (.@category$ == "M") {
		if (#CARD_M$ == "") #CARD_M$ = "|";
		#CARD_M$ = #CARD_M$ + .@item_id + "|";
	}
	else if (.@category$ == "N") {
		if (#CARD_N$ == "") #CARD_N$ = "|";
		#CARD_N$ = #CARD_N$ + .@item_id + "|";
	}
	else if (.@category$ == "O") {
		if (#CARD_O$ == "") #CARD_O$ = "|";
		#CARD_O$ = #CARD_O$ + .@item_id + "|";
	}
	else if (.@category$ == "P") {
		if (#CARD_P$ == "") #CARD_P$ = "|";
		#CARD_P$ = #CARD_P$ + .@item_id + "|";
	}
	else if (.@category$ == "Q") {
		if (#CARD_Q$ == "") #CARD_Q$ = "|";
		#CARD_Q$ = #CARD_Q$ + .@item_id + "|";
	}
	else if (.@category$ == "R") {
		if (#CARD_R$ == "") #CARD_R$ = "|";
		#CARD_R$ = #CARD_R$ + .@item_id + "|";
	}
	else if (.@category$ == "S") {
		if (#CARD_S$ == "") #CARD_S$ = "|";
		#CARD_S$ = #CARD_S$ + .@item_id + "|";
	}
	else if (.@category$ == "T") {
		if (#CARD_T$ == "") #CARD_T$ = "|";
		#CARD_T$ = #CARD_T$ + .@item_id + "|";
	}
	else if (.@category$ == "U") {
		if (#CARD_U$ == "") #CARD_U$ = "|";
		#CARD_U$ = #CARD_U$ + .@item_id + "|";
	}
	else if (.@category$ == "V") {
		if (#CARD_V$ == "") #CARD_V$ = "|";
		#CARD_V$ = #CARD_V$ + .@item_id + "|";
	}
	else if (.@category$ == "W") {
		if (#CARD_W$ == "") #CARD_W$ = "|";
		#CARD_W$ = #CARD_W$ + .@item_id + "|";
	}
	else if (.@category$ == "Y") {
		if (#CARD_Y$ == "") #CARD_Y$ = "|";
		#CARD_Y$ = #CARD_Y$ + .@item_id + "|";
	}
	else if (.@category$ == "Z") {
		if (#CARD_Z$ == "") #CARD_Z$ = "|";
		#CARD_Z$ = #CARD_Z$ + .@item_id + "|";
	}
	else if (.@category$ == "BOSS") {
		// BOSS split: first 40 cards go to BOSS1, rest to BOSS2
		// Initialize if empty
		if (#CARD_BOSS1$ == "") #CARD_BOSS1$ = "|";
		if (#CARD_BOSS2$ == "") #CARD_BOSS2$ = "|";
		// Calculate estimated position
		.@len = getstrlen(#CARD_BOSS1$);
		if (.@len < 200) {
			#CARD_BOSS1$ = #CARD_BOSS1$ + .@item_id + "|";
		} else {
			#CARD_BOSS2$ = #CARD_BOSS2$ + .@item_id + "|";
		}
	}
	else if (.@category$ == "MVP") {
		// MVP split: first 40 cards go to MVP1, rest to MVP2
		// Initialize if empty
		if (#CARD_MVP1$ == "") #CARD_MVP1$ = "|";
		if (#CARD_MVP2$ == "") #CARD_MVP2$ = "|";
		// Calculate estimated position
		.@len = getstrlen(#CARD_MVP1$);
		if (.@len < 200) {
			#CARD_MVP1$ = #CARD_MVP1$ + .@item_id + "|";
		} else {
			#CARD_MVP2$ = #CARD_MVP2$ + .@item_id + "|";
		}
	}
	
	return;
}

// ===== FUNCTION: Migrate Old Format Data =====
function MigrateOldFormat {
	// Fix old format data that doesn't start with "|"
	// Old: "4013|4032|" -> New: "|4013|4032|"
	// Check if first character is not "|" by seeing if "|" is at position 0
	if (#CARD_A$ != "" && strpos(#CARD_A$, "|") != 0) #CARD_A$ = "|" + #CARD_A$;
	if (#CARD_B$ != "" && strpos(#CARD_B$, "|") != 0) #CARD_B$ = "|" + #CARD_B$;
	if (#CARD_C$ != "" && strpos(#CARD_C$, "|") != 0) #CARD_C$ = "|" + #CARD_C$;
	if (#CARD_D$ != "" && strpos(#CARD_D$, "|") != 0) #CARD_D$ = "|" + #CARD_D$;
	if (#CARD_F$ != "" && strpos(#CARD_F$, "|") != 0) #CARD_F$ = "|" + #CARD_F$;
	if (#CARD_G$ != "" && strpos(#CARD_G$, "|") != 0) #CARD_G$ = "|" + #CARD_G$;
	if (#CARD_H$ != "" && strpos(#CARD_H$, "|") != 0) #CARD_H$ = "|" + #CARD_H$;
	if (#CARD_I$ != "" && strpos(#CARD_I$, "|") != 0) #CARD_I$ = "|" + #CARD_I$;
	if (#CARD_J$ != "" && strpos(#CARD_J$, "|") != 0) #CARD_J$ = "|" + #CARD_J$;
	if (#CARD_K$ != "" && strpos(#CARD_K$, "|") != 0) #CARD_K$ = "|" + #CARD_K$;
	if (#CARD_L$ != "" && strpos(#CARD_L$, "|") != 0) #CARD_L$ = "|" + #CARD_L$;
	if (#CARD_M$ != "" && strpos(#CARD_M$, "|") != 0) #CARD_M$ = "|" + #CARD_M$;
	if (#CARD_N$ != "" && strpos(#CARD_N$, "|") != 0) #CARD_N$ = "|" + #CARD_N$;
	if (#CARD_O$ != "" && strpos(#CARD_O$, "|") != 0) #CARD_O$ = "|" + #CARD_O$;
	if (#CARD_P$ != "" && strpos(#CARD_P$, "|") != 0) #CARD_P$ = "|" + #CARD_P$;
	if (#CARD_Q$ != "" && strpos(#CARD_Q$, "|") != 0) #CARD_Q$ = "|" + #CARD_Q$;
	if (#CARD_R$ != "" && strpos(#CARD_R$, "|") != 0) #CARD_R$ = "|" + #CARD_R$;
	if (#CARD_S$ != "" && strpos(#CARD_S$, "|") != 0) #CARD_S$ = "|" + #CARD_S$;
	if (#CARD_T$ != "" && strpos(#CARD_T$, "|") != 0) #CARD_T$ = "|" + #CARD_T$;
	if (#CARD_U$ != "" && strpos(#CARD_U$, "|") != 0) #CARD_U$ = "|" + #CARD_U$;
	if (#CARD_V$ != "" && strpos(#CARD_V$, "|") != 0) #CARD_V$ = "|" + #CARD_V$;
	if (#CARD_W$ != "" && strpos(#CARD_W$, "|") != 0) #CARD_W$ = "|" + #CARD_W$;
	if (#CARD_Y$ != "" && strpos(#CARD_Y$, "|") != 0) #CARD_Y$ = "|" + #CARD_Y$;
	if (#CARD_Z$ != "" && strpos(#CARD_Z$, "|") != 0) #CARD_Z$ = "|" + #CARD_Z$;
	if (#CARD_BOSS1$ != "" && strpos(#CARD_BOSS1$, "|") != 0) #CARD_BOSS1$ = "|" + #CARD_BOSS1$;
	if (#CARD_BOSS2$ != "" && strpos(#CARD_BOSS2$, "|") != 0) #CARD_BOSS2$ = "|" + #CARD_BOSS2$;
	if (#CARD_MVP1$ != "" && strpos(#CARD_MVP1$, "|") != 0) #CARD_MVP1$ = "|" + #CARD_MVP1$;
	if (#CARD_MVP2$ != "" && strpos(#CARD_MVP2$, "|") != 0) #CARD_MVP2$ = "|" + #CARD_MVP2$;
	return;
}



OnInit:
	.npc_name$ = "[ Card Collector ]";

	setarray .carta_A, 4013,4032,4043,4062,4075,4094,4114,4138,4160,4234,4240,4242,4244,4245,4246,4247,4248,4249,4252,4253,4344,4347,4371,4378,4379,4387,4400,4401,4402,4409,4443,4464,4473,4513,4515,4567,4596,4629,31022;
	setarray .carta_B, 4074,4119,4129,4212,4213,4214,4215,4233,4320,4327,4356,4390,4438,4450,4466,4472,4518,4519,4582,4626,4627;
	setarray .carta_C, 4009,4015,4040,4041,4061,4063,4153,4202,4229,4235,4284,4285,4288,4289,4293,4296,4297,4298,4299,4368,4373,4447,4448,4452,4475,4516,4517,4568,4569,4595,27182,27361;
	setarray .carta_D, 4004,4023,4056,4069,4082,4098,4122,4125,4133,4170,4173,4176,4177,4178,4180,4181,4182,4272,4279,4370,4385,4388,4421,4444,4449,4458,4506;
	setarray .carta_F, 4002,4020,4080,4088,4158,4312,4316,4319,4380,4381,4405,4439,4570,4607;
	setarray .carta_G, 4060,4072,4087,4110,4149,4150,4151,4152,4155,4157,4161,4162,4164,4165,4270,4271,4278,4280,4283,4323,4355,4377,4418,4508,4571;
	setarray .carta_H, 4019,4035,4045,4081,4103,4115,4321,4322,4325,4328,4331,4345,4362,4413,4437,4453,4467,4477;
	setarray .carta_I, 4116,4231,4239,4268,4269,4412,4417,4433;
	setarray .carta_J, 4109,4139,4474,4589;
	setarray .carta_K, 4027,4065,4091,4136,4140,4286,4287,4291,4292,4295,4301,4307,4351,4366,4434;
	setarray .carta_L, 4006,4184,4188,4191,4193,4195,4217,4265,4445,4459,4511,4579,4597,4598,4599,4600,4663;
	setarray .carta_M, 4030,4036,4046,4055,4057,4067,4076,4079,4084,4090,4095,4097,4105,4106,4108,4112,4113,4124,4126,4196,4199,4200,4201,4204,4205,4206,4208,4317,4339,4341,4343,4364,4420,4432,4510,4584,4585,4593;
	setarray .carta_N, 4127,4159,4166,4167,4334,4382,4383,4469,4470,4545,4628;
	setarray .carta_O, 4066,4071,4085,4093,4255,4256,4338,4375;
	setarray .carta_P, 4001,4003,4005,4007,4008,4011,4024,4031,4033,4048,4073,4077,4099,4118,4120,4175,4309,4310,4311,4313,4314,4315,4329,4335,4337,4389,4461,4465,4468,4476,4512,4514,4523,4594;
	setarray .carta_Q, 4294;
	setarray .carta_R, 4014,4021,4083,4104,4154,4185,4186,4187,4192,4194,4350,4353,4422,4436,4460,4531,4572,4581,27352;
	setarray .carta_S, 4017,4022,4025,4037,4039,4042,4044,4068,4078,4086,4089,4092,4100,4101,4111,4117,4156,4216,4218,4219,4220,4221,4222,4223,4224,4225,4226,4227,4228,4230,4273,4326,4358,4404,4414,4415,4416,4424,4505,4521,4522,4530,4575;
	setarray .carta_T, 4012,4016,4026,4028,4050,4058,4172,4282,4304,4308,4340,4442,4573,4586,4587,4630;
	setarray .carta_U, 4336;
	setarray .carta_V, 4049,4053,4107,4209,4211,4333,4369,4411;
	setarray .carta_W, 4010,4029,4034,4102,4189,4190,4210,4232,4257,4258,4259,4260,4261,4264,4303,4332,4348,4558,4588;
	setarray .carta_Y, 4051,4346;
	setarray .carta_Z, 4038,4064,4096,4274,4275,4277,4281,4435;
	setarray .carta_BOSS, 4047,4054,4130,4147,4163,4169,4171,4174,4179,4183,4197,4198,4203,4207,4237,4238,4241,4254,4290,4300,4306,4354,4384,4391,4392,4393,4394,4395,4396,4397,4398,4406,4423,4426,4427,4428,4429,4431,4440,4451,4457,4462,4463,4509,4520,4524,4526,4527,4528,4529,4532,4533,4534,4560,4561,4562,4563,4564,4565,4566,4590,4591,4605,4606,4610,4631,4632;
	setarray .carta_MVP, 4121,4128,4131,4132,4134,4135,4137,4142,4143,4144,4145,4146,4147,4148,4168,4236,4263,4276,4302,4305,4318,4324,4330,4342,4352,4357,4359,4361,4363,4365,4367,4372,4374,4376,4386,4399,4403,4407,4408,4419,4425,4430,4441,4456,4507,4525,4574,4576,4578,4580,4592,4601,4603,4625,27164;
	
	end;
}

// Duplicates
//============================================================
geffen,158,40,1	duplicate(Card Collector)	Card Collector#gef	1_M_SIGNALCHE
prontera,123,98,3	duplicate(Card Collector)	Card Collector#prt	4_F_ALCHE